// drag-drop-touch@1.3.1 downloaded from https://ga.jspm.io/npm:drag-drop-touch@1.3.1/DragDropTouch.js

var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e;(function(e){var r=function(){function DataTransfer(){(this||t)._dropEffect="move";(this||t)._effectAllowed="all";(this||t)._data={}}Object.defineProperty(DataTransfer.prototype,"dropEffect",{get:function(){return(this||t)._dropEffect},set:function(e){(this||t)._dropEffect=e},enumerable:true,configurable:true});Object.defineProperty(DataTransfer.prototype,"effectAllowed",{get:function(){return(this||t)._effectAllowed},set:function(e){(this||t)._effectAllowed=e},enumerable:true,configurable:true});Object.defineProperty(DataTransfer.prototype,"types",{get:function(){return Object.keys((this||t)._data)},enumerable:true,configurable:true});DataTransfer.prototype.clearData=function(e){null!=e?delete(this||t)._data[e]:(this||t)._data=null};DataTransfer.prototype.getData=function(e){return(this||t)._data[e]||""};DataTransfer.prototype.setData=function(e,r){(this||t)._data[e]=r};DataTransfer.prototype.setDragImage=function(t,e,r){var a=o._instance;a._imgCustom=t;a._imgOffset={x:e,y:r}};return DataTransfer}();e.DataTransfer=r;var o=function(){function DragDropTouch(){(this||t)._lastClick=0;if(DragDropTouch._instance)throw"DragDropTouch instance already created.";var e=false;document.addEventListener("test",(function(){}),{get passive(){e=true;return true}});if("ontouchstart"in document){var r=document,o=(this||t)._touchstart.bind(this||t),a=(this||t)._touchmove.bind(this||t),i=(this||t)._touchend.bind(this||t),n=!!e&&{passive:false,capture:false};r.addEventListener("touchstart",o,n);r.addEventListener("touchmove",a,n);r.addEventListener("touchend",i);r.addEventListener("touchcancel",i)}}DragDropTouch.getInstance=function(){return DragDropTouch._instance};DragDropTouch.prototype._touchstart=function(e){var r=this||t;if(this._shouldHandle(e)){if(Date.now()-(this||t)._lastClick<DragDropTouch._DBLCLICK&&this._dispatchEvent(e,"dblclick",e.target)){e.cancelable&&e.preventDefault();this._reset();return}this._reset();var o=this._closestDraggable(e.target);if(o&&!this._dispatchEvent(e,"mousemove",e.target)&&!this._dispatchEvent(e,"mousedown",e.target)){(this||t)._dragSource=o;(this||t)._ptDown=this._getPoint(e);(this||t)._lastTouch=e;e.cancelable&&e.preventDefault();setTimeout((function(){r._dragSource==o&&null==r._img&&r._dispatchEvent(e,"contextmenu",o)&&r._reset()}),DragDropTouch._CTXMENU);DragDropTouch._ISPRESSHOLDMODE&&((this||t)._pressHoldInterval=setTimeout((function(){r._isDragEnabled=true;r._touchmove(e)}),DragDropTouch._PRESSHOLDAWAIT))}}};DragDropTouch.prototype._touchmove=function(e){if(this._shouldCancelPressHoldMove(e))this._reset();else if(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e)){var r=this._getTarget(e);if(this._dispatchEvent(e,"mousemove",r)){(this||t)._lastTouch=e;e.cancelable&&e.preventDefault();return}if((this||t)._dragSource&&!(this||t)._img&&this._shouldStartDragging(e)){this._dispatchEvent(e,"dragstart",(this||t)._dragSource);this._createImage(e);this._dispatchEvent(e,"dragenter",r)}if((this||t)._img){(this||t)._lastTouch=e;e.cancelable&&e.preventDefault();if(r!=(this||t)._lastTarget){this._dispatchEvent((this||t)._lastTouch,"dragleave",(this||t)._lastTarget);this._dispatchEvent(e,"dragenter",r);(this||t)._lastTarget=r}this._moveImage(e);(this||t)._isDropZone=this._dispatchEvent(e,"dragover",r)}}};DragDropTouch.prototype._touchend=function(e){if(this._shouldHandle(e)){if(this._dispatchEvent((this||t)._lastTouch,"mouseup",e.target)){e.cancelable&&e.preventDefault();return}if(!(this||t)._img){(this||t)._dragSource=null;this._dispatchEvent((this||t)._lastTouch,"click",e.target);(this||t)._lastClick=Date.now()}this._destroyImage();if((this||t)._dragSource){e.type.indexOf("cancel")<0&&(this||t)._isDropZone&&this._dispatchEvent((this||t)._lastTouch,"drop",(this||t)._lastTarget);this._dispatchEvent((this||t)._lastTouch,"dragend",(this||t)._dragSource);this._reset()}}};DragDropTouch.prototype._shouldHandle=function(t){return t&&!t.defaultPrevented&&t.touches&&t.touches.length<2};DragDropTouch.prototype._shouldHandleMove=function(t){return!DragDropTouch._ISPRESSHOLDMODE&&this._shouldHandle(t)};DragDropTouch.prototype._shouldHandlePressHoldMove=function(e){return DragDropTouch._ISPRESSHOLDMODE&&(this||t)._isDragEnabled&&e&&e.touches&&e.touches.length};DragDropTouch.prototype._shouldCancelPressHoldMove=function(e){return DragDropTouch._ISPRESSHOLDMODE&&!(this||t)._isDragEnabled&&this._getDelta(e)>DragDropTouch._PRESSHOLDMARGIN};DragDropTouch.prototype._shouldStartDragging=function(t){var e=this._getDelta(t);return e>DragDropTouch._THRESHOLD||DragDropTouch._ISPRESSHOLDMODE&&e>=DragDropTouch._PRESSHOLDTHRESHOLD};DragDropTouch.prototype._reset=function(){this._destroyImage();(this||t)._dragSource=null;(this||t)._lastTouch=null;(this||t)._lastTarget=null;(this||t)._ptDown=null;(this||t)._isDragEnabled=false;(this||t)._isDropZone=false;(this||t)._dataTransfer=new r;clearInterval((this||t)._pressHoldInterval)};DragDropTouch.prototype._getPoint=function(t,e){t&&t.touches&&(t=t.touches[0]);return{x:e?t.pageX:t.clientX,y:e?t.pageY:t.clientY}};DragDropTouch.prototype._getDelta=function(e){if(DragDropTouch._ISPRESSHOLDMODE&&!(this||t)._ptDown)return 0;var r=this._getPoint(e);return Math.abs(r.x-(this||t)._ptDown.x)+Math.abs(r.y-(this||t)._ptDown.y)};DragDropTouch.prototype._getTarget=function(t){var e=this._getPoint(t),r=document.elementFromPoint(e.x,e.y);while(r&&"none"==getComputedStyle(r).pointerEvents)r=r.parentElement;return r};DragDropTouch.prototype._createImage=function(e){(this||t)._img&&this._destroyImage();var r=(this||t)._imgCustom||(this||t)._dragSource;(this||t)._img=r.cloneNode(true);this._copyStyle(r,(this||t)._img);(this||t)._img.style.top=(this||t)._img.style.left="-9999px";if(!(this||t)._imgCustom){var o=r.getBoundingClientRect(),a=this._getPoint(e);(this||t)._imgOffset={x:a.x-o.left,y:a.y-o.top};(this||t)._img.style.opacity=DragDropTouch._OPACITY.toString()}this._moveImage(e);document.body.appendChild((this||t)._img)};DragDropTouch.prototype._destroyImage=function(){(this||t)._img&&(this||t)._img.parentElement&&(this||t)._img.parentElement.removeChild((this||t)._img);(this||t)._img=null;(this||t)._imgCustom=null};DragDropTouch.prototype._moveImage=function(e){var r=this||t;requestAnimationFrame((function(){if(r._img){var t=r._getPoint(e,true),o=r._img.style;o.position="absolute";o.pointerEvents="none";o.zIndex="999999";o.left=Math.round(t.x-r._imgOffset.x)+"px";o.top=Math.round(t.y-r._imgOffset.y)+"px"}}))};DragDropTouch.prototype._copyProps=function(t,e,r){for(var o=0;o<r.length;o++){var a=r[o];t[a]=e[a]}};DragDropTouch.prototype._copyStyle=function(t,e){DragDropTouch._rmvAtts.forEach((function(t){e.removeAttribute(t)}));if(t instanceof HTMLCanvasElement){var r=t,o=e;o.width=r.width;o.height=r.height;o.getContext("2d").drawImage(r,0,0)}var a=getComputedStyle(t);for(var i=0;i<a.length;i++){var n=a[i];n.indexOf("transition")<0&&(e.style[n]=a[n])}e.style.pointerEvents="none";for(var i=0;i<t.children.length;i++)this._copyStyle(t.children[i],e.children[i])};DragDropTouch.prototype._dispatchEvent=function(e,r,o){if(e&&o){var a=document.createEvent("Event"),i=e.touches?e.touches[0]:e;a.initEvent(r,true,true);a.button=0;a.which=a.buttons=1;this._copyProps(a,e,DragDropTouch._kbdProps);this._copyProps(a,i,DragDropTouch._ptProps);a.dataTransfer=(this||t)._dataTransfer;o.dispatchEvent(a);return a.defaultPrevented}return false};DragDropTouch.prototype._closestDraggable=function(t){for(;t;t=t.parentElement)if(t.hasAttribute("draggable")&&t.draggable)return t;return null};return DragDropTouch}();o._instance=new o;o._THRESHOLD=5;o._OPACITY=.5;o._DBLCLICK=500;o._CTXMENU=900;o._ISPRESSHOLDMODE=false;o._PRESSHOLDAWAIT=400;o._PRESSHOLDMARGIN=25;o._PRESSHOLDTHRESHOLD=0;o._rmvAtts="id,class,style,draggable".split(",");o._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(",");o._ptProps="pageX,pageY,clientX,clientY,screenX,screenY".split(",");e.DragDropTouch=o})(e||(e={}));var r={};export default r;

